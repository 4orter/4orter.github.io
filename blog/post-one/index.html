<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="/assets/styles/style.css"><link rel="stylesheet" href="/assets/styles/syntax.css"><style>.turbo-progress-bar{visibility: hidden;}</style><title>How to Build a Basic Server in Go</title><script type="module">import * as Turbo from "https://cdn.skypack.dev/@hotwired/turbo";</script><script defer="defer" src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script></head><body><div class="site" x-data="{ scrollAtTop: true }"><header class="fixed top-0 left-0 right-0 w-full px-3 desktop:px-0 bg-main z-20" :class="scrollAtTop ? '' : 'bar-shadow'" @scroll.window="scrollAtTop = (window.pageYOffset > 0) ? false : true"><h1 class="overflow-hidden whitespace-nowrap overflow-ellipsis pt-3 mx-auto max-w-screen-800 text-silver-300 font-extrabold pl-16 desktop:pl-0">How to Build a Basic Server in Go</h1><nav class="mx-3 desktop:mx-0 fixed bottom-0 left-0 right-0 z-10 desktop:relative desktop:top-auto desktop:bottom-auto desktop:left-auto" role="navigation"><div class="navbar"><div class="text-center text-xs"><a href="/" class="navbar-tab"><div class="navbar-tab-icon"><svg xmlns="http://www.w3.org/2000/svg" class="" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg></div>Home</a></div><div class="text-center text-xs"><a href="/about/" class="navbar-tab"><div class="navbar-tab-icon"><svg xmlns="http://www.w3.org/2000/svg" class="" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg></div>About</a></div><div class="text-center text-xs"><a href="/skills/" class="navbar-tab"><div class="navbar-tab-icon"><svg xmlns="http://www.w3.org/2000/svg" class="" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"/></svg></div>Skills</a></div><div class="text-center text-xs"><a href="/work/" class="navbar-tab"><div class="navbar-tab-icon"><svg xmlns="http://www.w3.org/2000/svg" class="" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg></div>Work</a></div><div class="text-center text-xs"><a href="/experience/" class="navbar-tab"><div class="navbar-tab-icon"><svg xmlns="http://www.w3.org/2000/svg" class="" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/></svg></div>Experience</a></div></div></nav><button class="back-button" @click="if (document.referrer.includes('127.0.0.1')) { history.back() } else { window.location.href = '/' }"><svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"/></svg></button></header><hr><main><section><h3 class="text-xl">How to Build a Basic Server in Go</h3><p class="italic mb-3">January 29, 2021</p><div class="py-3 blog-content"><p>In this tutorial, we're going to be taking look at how to build a very basic HTTP server in <a href="https://golang.org/" rel="nofollow noopener noreferrer" target="_blank">Go</a> using the <a href="https://golang.org/pkg/net/http/" rel="nofollow noopener noreferrer" target="_blank"><code>net/http</code></a> package.</p><h2>Prerequisites</h2><ul><li>Working knowledge of Go</li><li>Basic knowledge on HTTP request methods and CRUD</li><li>Go version 1.15+</li></ul><h2 id="hello-server">Hello Go Server!</h2><p>To get started, we'll first look at a simple HTTP server that returns the phrase <code>&quot;Hello Go server!&quot;</code> to the client when a <code>GET</code> request is made to the <code>&quot;/&quot;</code> endpoint:</p><pre class="language-go"><code class="language-go"><span class="token keyword">package</span> main<br><br><span class="token keyword">import</span> <span class="token punctuation">(</span><br>    <span class="token string">"fmt"</span><br>    <span class="token string">"net/http"</span><br>    <span class="token string">"log"</span><br><span class="token punctuation">)</span><br><br><span class="token keyword">func</span> <span class="token function">helloHandler</span><span class="token punctuation">(</span>res http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"Hello Go Server!"</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> helloHandler<span class="token punctuation">)</span><br><br>    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Starting server on port 8080..."</span><span class="token punctuation">)</span><br>    <span class="token keyword">if</span> err <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span><br>        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>As you can see, writing a HTTP server in Go is pretty simple. As a matter of fact, writing anything in Go feels pretty &quot;simple&quot; compared any other strongly-typed language. Making Go <em>feel</em> simple was an intentional design decision, which you can read more about here: <a href="https://talks.golang.org/2015/simplicity-is-complicated.slide" rel="nofollow noopener noreferrer" target="_blank">Simplicity is Complicated</a>.</p><br><p>To understand what's going on in this program, let's cover each line.</p><br><h3>package main</h3><pre class="language-go"><code class="language-go"><span class="token keyword">package</span> main</code></pre><p>Go programs are made up of packages, and the <code>main</code> package is where your program starts running.</p><br><h3>import</h3><pre class="language-go"><code class="language-go"><span class="token keyword">import</span> <span class="token punctuation">(</span><br>    <span class="token string">"fmt"</span><br>    <span class="token string">"net/http"</span><br>    <span class="token string">"log"</span><br><span class="token punctuation">)</span></code></pre><p>We can import other packages using the <code>import</code> keyword followed by the name of the package in quotations marks. Here, we're using a &quot;factored&quot; import statement which has a shorter syntax. Instead of writing the <code>import</code> statement several times, we can write it once and put the names of the packages we need inside parentheses with each package name on a separate line.</p><br><h3>func helloHandler()</h3><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">helloHandler</span><span class="token punctuation">(</span>res http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"Hello Go Server!"</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre><p>An important concept in building HTTP servers with Go is <em>handler functions</em>. Handler functions do the work of responding to the client after a request is made. When building servers using the <code>net/http</code> package, handler functions need to have a specific signature; they need to take a <code>http.ResponseWriter</code> and a pointer to a <code>http.Request</code>. Simply put, the <code>http.ResponseWriter</code> is used to construct and send an HTTP response back to the client and the <code>http.Request</code> contains information about the request sent from the client.</p><br><p>Because our <code>helloHandler()</code> function has the correct signature, it qualifies to be used as a handler function. It has a single statement where we're using the <code>fmt.Fprintf()</code> function to write the string <code>&quot;Hello Go Server!&quot;</code> to the <code>http.ResponseWriter</code> object. The <code>fmt.Fprintf()</code> function works by writing its second argument as a stream of bytes to its first argument which implements the <code>io.Writer</code> interface.</p><br><p>It should be noted that <code>fmt.Fprintf()</code> has a return type of <code>(int, error)</code>. In a production application, the values returned should be stored in temporary variables, evaluated and handled properly.</p><br><h3>func main()</h3><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> helloHandler<span class="token punctuation">)</span><br><br>    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Starting server on port 8080..."</span><span class="token punctuation">)</span><br>    <span class="token keyword">if</span> err <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span><br>        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>The <code>main()</code> function is where our program starts its execution.</p><br><p>In our <code>main()</code> function we are making a call to <code>http.HandleFunc()</code>. The <code>http.HandleFunc()</code> function registers handler functions for the default router in the <code>net/http</code> package. We are registering our <code>helloHandler()</code> function for the <code>&quot;/&quot;</code> endpoint / pattern.</p><br><p>Before starting our server, we print the line <code>Starting server on port 8080...</code> to the console using the <code>fmt.Println()</code> function. To start our sever, we make a call to <code>http.ListenAndServe()</code>, while passing it the name of the port (<code>:8080</code>) and <code>nil</code> to use the default router.</p><br><p>The <code>http.ListenAndServe()</code> runs a potential endless loop and it always returns a non-nil <code>error</code>, so we handle the <code>error</code> by making a call to <code>log.Fatal()</code>. <code>log.Fatal()</code> is similar to <code>fmt.Print()</code> but it has the additional feature of making a call to <code>os.Exit(1)</code> which terminates the program with a status code of <code>1</code>.</p><h2 id="running-server">Running the Server</h2><p>Now that we understand what's going on in this program, let's open a new terminal window and navigate to the directory where our program file lives. We can now run the program by using the command <code>go run main.go</code> in the terminal. If your file has a different name, replace <code>main.go</code> with the name of your file in the <code>go run</code> command. Once the program starts, we should see the words <code>Starting server on port 8080...</code> in the terminal. Let us now navigate to <code>http://localhost:8080/</code> in our browser client. We should be presented with the words <code>Hello Go Server!</code> when we navigate to the page.</p><h2 id="building-calculator">Building a Basic Calculator</h2><p>Before building our calculator, let's think about what our basic calculator would do. We'll give it the ability to do four basic mathematical operations – add, subtract, multiply and divide – on two operands and return the result of the calculation.</p><br><p>To get started, let's create a new project folder. Name it whatever you want; I'm going to name my folder <code>go-calculator</code>. Then, create a new file within that newly created folder and name it <code>main.go</code>; this is the file where we'll write our program. Once you've create a <code>main.go</code> file in your project folder, open that file and write in it the following code:</p><pre class="language-go"><code class="language-go"><span class="token keyword">package</span> main<br><br><span class="token keyword">import</span> <span class="token punctuation">(</span><br>    <span class="token string">"fmt"</span><br><span class="token punctuation">)</span><br><br><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Hello Go!"</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre><p>To run this program, open a new terminal window and change directories to your project folder. Run the command <code>go run main.go</code> and you should see the words <code>Hello Go!</code> in your terminal. This program simply uses the <code>fmt.Println()</code> function to print a string to the console.</p><br><h3>Writing the Handler Function</h3><p>That's cool and all but we're trying to build a server that functions as a basic calculator. So let's write a handler function that's able to parse form values through the URL, store and use those values to perform some calculation and return the result of the calculation back to the client:</p><pre class="language-go"><code class="language-go"><span class="token keyword">package</span> main<br><br><span class="token keyword">import</span> <span class="token punctuation">(</span><br>    <span class="token string">"fmt"</span><br>    <span class="token string">"strconv"</span><br><span class="token punctuation">)</span><br><br><span class="token keyword">func</span> <span class="token function">calculatorHandler</span><span class="token punctuation">(</span>res http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Parse arguments, we have to call this to populate request form values</span><br>    req<span class="token punctuation">.</span><span class="token function">ParseForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br>    <span class="token comment">// Get form values and make sure that they are in the correct format</span><br>    operation <span class="token operator">:=</span> req<span class="token punctuation">.</span><span class="token function">FormValue</span><span class="token punctuation">(</span><span class="token string">"operation"</span><span class="token punctuation">)</span><br>    leftOperand<span class="token punctuation">,</span> err <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">ParseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">FormValue</span><span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><br>    rightOperand<span class="token punctuation">,</span> err <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">ParseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">FormValue</span><span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><br>    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">||</span> operation <span class="token operator">==</span> <span class="token string">""</span> <span class="token punctuation">{</span><br>        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"Unable to parse request"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">return</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Do calculation based on the values provided</span><br>    <span class="token keyword">switch</span> operation <span class="token punctuation">{</span><br>    <span class="token keyword">case</span> <span class="token string">"add"</span><span class="token punctuation">:</span><br>        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> leftOperand <span class="token operator">+</span> rightOperand<span class="token punctuation">)</span><br>            <span class="token keyword">return</span><br>    <span class="token keyword">case</span> <span class="token string">"subtract"</span><span class="token punctuation">:</span><br>        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> leftOperand <span class="token operator">-</span> rightOperand<span class="token punctuation">)</span><br>            <span class="token keyword">return</span><br>    <span class="token keyword">case</span> <span class="token string">"multiply"</span><span class="token punctuation">:</span><br>            fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> leftOperand <span class="token operator">*</span> rightOperand<span class="token punctuation">)</span><br>            <span class="token keyword">return</span><br>    <span class="token keyword">case</span> <span class="token string">"divide"</span><span class="token punctuation">:</span><br>        <span class="token keyword">if</span> rightOperand <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span><br>            fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"Division by 0 not possible!"</span><span class="token punctuation">)</span><br>            <span class="token keyword">return</span><br>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>            fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> leftOperand <span class="token operator">/</span> rightOperand<span class="token punctuation">)</span><br>            <span class="token keyword">return</span><br>        <span class="token punctuation">}</span><br>    <span class="token keyword">default</span><span class="token punctuation">:</span><br>        <span class="token comment">// Unknown operation...</span><br>        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"Unknown operation!"</span><span class="token punctuation">)</span><br>        <span class="token keyword">return</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Some unknown error...</span><br>    fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"Unknown error!"</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Hello Go!"</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre><p>Let's go over each part of our function.</p><br><h3>func calculatorHandler()</h3><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">calculatorHandler</span><span class="token punctuation">(</span>res http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token operator">...</span><br><span class="token punctuation">}</span></code></pre><p>We first create our function and give it a name of <code>calculatorHandler</code>, and we make sure our function has the correct signature so it can be used as a handler function for our server. Remember, it needs to take a <code>http.ResponseWriter</code> and a pointer to a <code>http.Request</code>.</p><br><h3>req.ParseForm()</h3><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">calculatorHandler</span><span class="token punctuation">(</span>res http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Parse arguments, we have to call this to populate request form values</span><br>    req<span class="token punctuation">.</span><span class="token function">ParseForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br>    <span class="token operator">...</span><br><span class="token punctuation">}</span></code></pre><p>Next, we make a call the <code>ParseForm()</code> method on the <code>req</code> object to populate its form values. Form values are stored as key-value pairs within <code>req</code> object.</p><br><h3>req.FormValue()</h3><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">calculatorHandler</span><span class="token punctuation">(</span>res http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token operator">...</span><br><br>    <span class="token comment">// Get form values and make sure that they are in the correct format</span><br>    operation <span class="token operator">:=</span> req<span class="token punctuation">.</span><span class="token function">FormValue</span><span class="token punctuation">(</span><span class="token string">"operation"</span><span class="token punctuation">)</span><br>    leftOperand<span class="token punctuation">,</span> err <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">ParseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">FormValue</span><span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><br>    rightOperand<span class="token punctuation">,</span> err <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">ParseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">FormValue</span><span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><br>    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">||</span> operation <span class="token operator">==</span> <span class="token string">""</span> <span class="token punctuation">{</span><br>        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"Unable to parse request"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">return</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token operator">...</span><br><span class="token punctuation">}</span></code></pre><p>After we populate <code>req</code>'s form values, we can then call <code>req.FormValue()</code> to retrieve the individual values provided by the client so we can store them in variables and perform a calculation. We assume the form value keys are named <code>&quot;operation&quot;</code> (for the mathematical operation), <code>&quot;left&quot;</code> (for the left operand), and <code>&quot;right&quot;</code> (for the right operand); and we assume that the values of these keys are a string, a number, and another number respectively. As you can see, we're using the <code>&quot;strconv&quot;</code> package to attempt to convert the values returned from <code>req.FormValue(&quot;left&quot;)</code> and <code>req.FormValue(&quot;right&quot;)</code> to integers, and if the client doesn't provide the correct type of data, we return the message <code>&quot;Unable to parse request&quot;</code> to the client and return out of the function.</p><br><h3>switch operation</h3><pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">calculatorHandler</span><span class="token punctuation">(</span>res http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token operator">...</span><br><br>    <span class="token comment">// Do calculation based on the values provided</span><br>    <span class="token keyword">switch</span> operation <span class="token punctuation">{</span><br>    <span class="token keyword">case</span> <span class="token string">"add"</span><span class="token punctuation">:</span><br>        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> leftOperand <span class="token operator">+</span> rightOperand<span class="token punctuation">)</span><br>        <span class="token keyword">return</span><br>    <span class="token keyword">case</span> <span class="token string">"subtract"</span><span class="token punctuation">:</span><br>        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> leftOperand <span class="token operator">-</span> rightOperand<span class="token punctuation">)</span><br>        <span class="token keyword">return</span><br>    <span class="token keyword">case</span> <span class="token string">"multiply"</span><span class="token punctuation">:</span><br>        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> leftOperand <span class="token operator">*</span> rightOperand<span class="token punctuation">)</span><br>        <span class="token keyword">return</span><br>    <span class="token keyword">case</span> <span class="token string">"divide"</span><span class="token punctuation">:</span><br>        <span class="token keyword">if</span> rightOperand <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span><br>            fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"Division by 0 not possible!"</span><span class="token punctuation">)</span><br>            <span class="token keyword">return</span><br>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>            fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> leftOperand <span class="token operator">/</span> rightOperand<span class="token punctuation">)</span><br>            <span class="token keyword">return</span><br>        <span class="token punctuation">}</span><br>    <span class="token keyword">default</span><span class="token punctuation">:</span><br>        <span class="token comment">// Unknown operation...</span><br>        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"Unknown operation!"</span><span class="token punctuation">)</span><br>        <span class="token keyword">return</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token operator">...</span><br><span class="token punctuation">}</span></code></pre><p>After storing the operation, the left operand and the right operand in variables, we evaluate the operation. In the case that <code>operation</code> equals to <code>&quot;add&quot;</code>, we'll use the <code>fmt.Fprintf()</code> function to add the values in the <code>leftOperand</code> and <code>rightOperand</code> variables and write the result as a string back to the <code>http.ResponseWriter</code> and return out of the function. The rest of the cases in the <code>switch</code> statement are similar with exception to <code>case &quot;divide&quot;:</code> and <code>default:</code>.</p><br><p>In the case <code>operation</code> is equal to <code>&quot;divide&quot;</code>, we have to make sure the value inside the <code>rightOperand</code> variable is not equal to <code>0</code>. We know division by zero is an illegal operation, so we write the message <code>&quot;Division by 0 not possible&quot;</code> to the <code>http.ResponseWriter</code> object and return out of the function. If the value inside the <code>operation</code> variable is not equal to any of the cases, the function will come to the default case in which the operation is unknown and we write the message <code>&quot;Unknown operation!&quot;</code> to the <code>http.ResponseWriter</code> object and return out of the function.</p><br><h3>Refactoring the main() Function</h3><p>Let us now refactor the code inside our <code>main()</code> function by registering the <code>calculatorHandler()</code> handler function for the default router using the <code>&quot;net/http&quot;</code> package and making a call to <code>http.ListenAndServe()</code> to start our server.</p><pre class="language-go"><code class="language-go"><span class="token keyword">import</span> <span class="token punctuation">(</span><br>    <span class="token string">"fmt"</span><br>    <span class="token string">"strconv"</span><br>    <span class="token string">"net/http"</span><br>    <span class="token string">"log"</span><br><span class="token punctuation">)</span><br><br><span class="token keyword">func</span> <span class="token function">calculatorHandler</span><span class="token punctuation">(</span>res http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Parse arguments, we have to call this to populate request form values</span><br>    req<span class="token punctuation">.</span><span class="token function">ParseForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br>    <span class="token comment">// Get form values and make sure that they are in the correct format</span><br>    operation <span class="token operator">:=</span> req<span class="token punctuation">.</span><span class="token function">FormValue</span><span class="token punctuation">(</span><span class="token string">"operation"</span><span class="token punctuation">)</span><br>    leftOperand<span class="token punctuation">,</span> err <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">ParseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">FormValue</span><span class="token punctuation">(</span><span class="token string">"left"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><br>    rightOperand<span class="token punctuation">,</span> err <span class="token operator">:=</span> strconv<span class="token punctuation">.</span><span class="token function">ParseInt</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">FormValue</span><span class="token punctuation">(</span><span class="token string">"right"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><br>    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">||</span> operation <span class="token operator">==</span> <span class="token string">""</span> <span class="token punctuation">{</span><br>        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"Unable to parse request"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">return</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Do calculation based on the values provided</span><br>    <span class="token keyword">switch</span> operation <span class="token punctuation">{</span><br>    <span class="token keyword">case</span> <span class="token string">"add"</span><span class="token punctuation">:</span><br>        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> leftOperand <span class="token operator">+</span> rightOperand<span class="token punctuation">)</span><br>            <span class="token keyword">return</span><br>    <span class="token keyword">case</span> <span class="token string">"subtract"</span><span class="token punctuation">:</span><br>        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> leftOperand <span class="token operator">-</span> rightOperand<span class="token punctuation">)</span><br>            <span class="token keyword">return</span><br>    <span class="token keyword">case</span> <span class="token string">"multiply"</span><span class="token punctuation">:</span><br>            fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> leftOperand <span class="token operator">*</span> rightOperand<span class="token punctuation">)</span><br>            <span class="token keyword">return</span><br>    <span class="token keyword">case</span> <span class="token string">"divide"</span><span class="token punctuation">:</span><br>        <span class="token keyword">if</span> rightOperand <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span><br>            fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"Division by 0 not possible!"</span><span class="token punctuation">)</span><br>            <span class="token keyword">return</span><br>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>            fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"%d"</span><span class="token punctuation">,</span> leftOperand <span class="token operator">/</span> rightOperand<span class="token punctuation">)</span><br>            <span class="token keyword">return</span><br>        <span class="token punctuation">}</span><br>    <span class="token keyword">default</span><span class="token punctuation">:</span><br>        <span class="token comment">// Unknown operation...</span><br>        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"Unknown operation!"</span><span class="token punctuation">)</span><br>        <span class="token keyword">return</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Some unknown error...</span><br>    fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">"Unknown error!"</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> calculatorHandler<span class="token punctuation">)</span><br><br>    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Starting server on port 8080..."</span><span class="token punctuation">)</span><br>    <span class="token keyword">if</span> err <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":8080"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span><br>        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h3>Running the Server</h3><p>We can now run our server by running the command <code>go run main.go</code> in the terminal then navigate to the url <code>http://localhost:8080/?operation=add&amp;left=5&amp;right=4</code> in your browser client. We should see the number 9 on the page. Try changing the form values in the url and see what results you get!</p><h2 id="conclusion">Conclusion</h2><p>I hope this tutorial was useful in teaching you how to build a web server in Go. Feel free to shoot me a message on <a href="https://twitter.com/4orter" rel="nofollow noopener noreferrer" target="_blank">Twitter</a> or <a href="https://linkedin.com/in/4orter" rel="nofollow noopener noreferrer" target="_blank">LinkedIn</a> and let me know if this tutorial helped you!</p></div></section></main></div></body></html>